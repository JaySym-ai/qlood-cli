## qlood-cli

> Qlood CLI is the official, open-source companion to qlood.com for next‑generation AI testing.
>
> IMPORTANT: Qlood CLI is the first open‑source tool to use Auggie (augmentcode.com) CLI in non‑interactive mode. This project exists to demonstrate the power of Auggie’s Non‑Interactive mode for intelligent, context‑aware testing.

Highlights
- Uses AugmentCode (Auggie) to index your repo for deep project context and smarter testing decisions
- Headless by default with Playwright (bundled Chromium); great for CI and local dev
- Non‑interactive Auggie flows to run comprehensive checks automatically
- Results saved under ./.qlood/results/ with success/warning/error reports
- Workflows: create, run, update, and delete AI‑generated end‑to‑end test plans

What you get (from qlood.com)
- AI_SUPERPOWER: tests like a pro, thinks like a user, catches what humans miss
- LIGHTNING_FAST: ideal for CI/CD pipelines and rapid iteration
- BULLETPROOF: comprehensive analysis to keep your app production‑ready

### Why Auggie (augmentcode.com)
Qlood CLI is built around Auggie, the AugmentCode.com CLI, running in non‑interactive mode.

- Code‑aware indexing: Auggie scans and understands your codebase to build a rich, semantic context of your project
- Smarter actions: with this context, Qlood makes better choices for navigation, selectors, state, and validations
- Continuous adaptation: workflows can be updated as your code changes, keeping tests relevant
- Learn more: https://www.augmentcode.com/


Open-source CLI to help you test your own app. qlood initializes a project-local `./.qlood/` folder, then uses AI-driven browser automation (Chromium via Playwright + OpenRouter LLMs) to explore and find bugs in your web app. Mobile emulators (Android/iOS) are on the roadmap.

- One-package install with bundled Chromium
- Project-local state in `./.qlood` (config, results, notes)
- AI-assisted testing flows; will open your app and drive interactions
- Low-level browser commands still available for power users

### Why qlood
- Fast local setup: `qlood` prompts to create `./.qlood` in your repo.
- Reproducible runs: artifacts saved under `./.qlood/results/` (screenshots included).
- Adaptable: define your dev server URL and start command; the tool can launch it if needed.

### Install
- Prerequisites: Node.js 18+
- Local development:
  1) npm install
  2) npm link
  3) Set API key: export `OPENROUTER_API_KEY=...` (or use TUI `/key`)

- As a global package (when published):
  `npm i -g qlood-cli`

### Quick Start
- In your project root:
  - Run `qlood` — if not initialized, you’ll be prompted to create `./.qlood` and auto-detect sensible defaults
  - Edit `./.qlood/qlood.json` if needed (URL/start command/healthcheck)
  - Run `qlood test "Sign in and create a post"` — runs an AI-driven scenario against your app

### How It Work
This is a concise, terminal-first guide to using qlood.

- Install:

  ```bash
  npm install -g qlood-cli
  ```

- Launch:

  ```bash
  qlood
  ```

- Initialize: qlood asks to initialize your project. Accepting also allows the AugmentCode CLI (Auggie) to index your project so it can take action and perform testing.

- Help: inside qlood, run:

  ```bash
  /help
  ```

- Useful workflow commands:

  ```bash
  /wfadd I need a workflow that test the user signup and login
  ```
  - Creates `./.qlood/workflows/1-user-signup-login.md` with steps generated by Auggie from your codebase.

  ```bash
  /wf 1
  ```
  - Runs workflow id 1.

  ```bash
  /wfall
  ```
  - Runs all workflows.

  ```bash
  /wdupdate 1
  ```
  - Reviews and adapts workflow 1 to recent code changes.

  ```bash
  /wfdel 1
  ```
  - Deletes workflow 1.

- Results:
  - Each run produces `./.qlood/results/wf#-%datetime%/` with subfolders:
    - `/success`: high-level report and references to artifacts
    - `/warning`: potential issues and `fix-prompt.md`
    - `/error`: errors with screenshots and `fix-prompt.md`

- Coverage of tests performed by qlood includes:
  - End-to-end user flows like a human
  - UI/UX issues and obvious anti-patterns
  - Console errors and warnings
  - Network performance signals and failures
  - Basic security/vulnerability heuristics
  - Authentication flow sanity checks
  - Dead links and navigation problems
  - API key exposure hints and URL rewrite sanity

### Usage
`qlood [command] [options]`

Core testing commands
- `test <scenario>`                   Run an AI-driven test scenario against your app

Maintenance
- `delete`                            Delete the `./.qlood` directory to reset initialization (formerly `clean`)

Global options
- `--headless`                        Run headless Chromium
- `--debug`                           Visible browser with slowMo for steps


Examples
- `qlood test "Create an account, log out, log back in" --debug`
- `qlood test "Try invalid passwords and report validation"`

Project config (`./.qlood/qlood.json`)
- `devServer.url`: Base URL of your app (e.g., `http://localhost:5173`)
- `devServer.start`: Command to start your dev server (e.g., `npm run dev`)
- `devServer.healthcheckPath`: Path to poll for readiness (default `/`)
- `devServer.waitTimeoutMs`: Max wait for server readiness (default `60000`)
- `devServer.waitIntervalMs`: Poll interval for readiness (default `1000`)
- `browser.headless`: Default headless mode for tests (default `false`)

Artifacts
- `./.qlood/results/<timestamp>/agent.log` — AI agent logs for the run
- `./.qlood/results/<timestamp>/browser.log` — page console and errors
- `./.qlood/results/<timestamp>/network.log` — request/response summary
- `./.qlood/results/<timestamp>/report.html` — minimal HTML report linking artifacts
- `./.qlood/results/<timestamp>/initial.png` — before test
- `./.qlood/results/<timestamp>/final.png` — after test
- `./.qlood/notes/` — free-form notes you keep

Interactive TUI
- `qlood` or `qlood tui`              Launches the TUI (prompts to init if needed)
- Slash commands: `/test <scenario>`, `/key <apiKey>`, `/open <url>`, `/goto <url>`, `/click <selector>`, `/type <selector> <text>`, `/tools`, `/quit`
- Input rule: all commands must start with `/` (use `/help`)
### Playwright/Chromium notes (headless, CI, sandbox)
- Headless mode: Qlood runs with Playwright in headless mode by default for speed and CI compatibility. Use `--debug` to see the browser.
- Permissions: Some CI environments require additional flags. If Chromium fails to launch, try setting env `PLAYWRIGHT_BROWSERS_PATH=0` and ensure Playwright is installed, or run `npx playwright install chromium`.
- Linux sandbox: In containerized Linux CI, you may need to disable sandboxing: set `PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=1` if you bundle Chromium elsewhere, or run Chromium with `--no-sandbox` (only in trusted CI) by configuring your CI container accordingly.
- GPU/Display: Headless has no display requirements. For non-headless debugging in CI, use Xvfb or a container with a virtual display.

- Ctrl+C: first press cancels current action, second within 1.5s exits

See /help or `qlood --help` for low-level commands.

### Environment
- `OPENROUTER_API_KEY`: your OpenRouter API key


Security note
- Prefer setting your API key via the TUI (`/key <apiKey>`) to avoid shell history capturing secrets.
- CLI alternative: `qlood config key <apiKey>` stores it in `~/.qlood/config.json` (never committed).

### Architecture
- `bin/qlood.js`: CLI entrypoint (Commander)
- `src/chrome.js`: Browser lifecycle and page helpers
- `src/commands.js`: Low-level page actions (open/goto/click/type)
- `src/agent.js`: AI agent loop powered by OpenRouter
- `src/project.js`: Project `./.qlood` folder and config helpers
- `src/test.js`: Project-level test runner that opens your app and runs scenarios
- `src/tui.js`: Interactive TUI for quick testing

### Roadmap
- Android/iOS emulator automation
- Richer assertions and reporting
- Auto-discovery of routes/actions; script recording
- Persistent user-data-dir profiles and cookies management

### Development
- Run: `node bin/qlood.js --help`
- Tests: TODO (set up Vitest/Jest)

### License
MIT
